---
interface Props {
  animation?: "fade-up" | "fade-in" | "scale-up";
  duration?: string;
  delay?: string;
}

const { 
  animation = "fade-up", 
  duration = "0.8s", 
  delay = "0s" 
} = Astro.props;
---

<div 
  class={`reveal-container ${animation}`} 
  style={`--duration: ${duration}; --delay: ${delay};`}
>
<!-- Aquí se carga el contenido -->
  <slot /> 
</div>

<style>
  .reveal-container {
    opacity: 0;
    transition: all var(--duration) cubic-bezier(0.5, 0, 0, 1);
    transition-delay: var(--delay);
    will-change: transform, opacity;
  }

  /* Definición de animaciones */
  .fade-up { transform: translateY(30px); }
  .fade-in { transform: scale(0.95); }
  .scale-up { transform: scale(0.8); }

  /* Estado cuando el componente es visible */
  .reveal-container.is-visible {
    opacity: 1;
    transform: translate(0) scale(1);
  }
</style>

<script>
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1 // Se activa cuando el 10% del elemento es visible
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        // Opcional: dejar de observar después de la animación
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  // Seleccionar todos los elementos con la clase reveal-container
  document.querySelectorAll('.reveal-container').forEach((el) => {
    observer.observe(el);
  });
</script>